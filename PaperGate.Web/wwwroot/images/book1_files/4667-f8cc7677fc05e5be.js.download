(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4667],{64503:function(e,o,t){"use strict";var s=t(85893),n=t(98772),a=t.n(n),r=t(85786),c=t(67294),i=t(96226),l=t(82118);o.Z=e=>{let[o,t]=(0,c.useState)(!1),{comment:n}=e,d=n.comment.split(" "),m=!1,u="";return d.length>40&&!o?(u=d.slice(0,40).join(" "),m=!0):u=n.comment,(0,s.jsxs)("div",{className:"".concat(a().comment," swiper-slide"),children:[(0,s.jsxs)("div",{className:"".concat(a().commentHeader),children:[(0,s.jsx)("div",{className:a().user,children:(0,s.jsx)(i.default,{uri:n.profileImageUri,name:n.nickname,rndColor:!0})}),(0,s.jsxs)("div",{className:a().bookHeaderInfo,children:[(0,s.jsx)("div",{className:a().bookHeaderNickname,children:n.nickname}),(0,s.jsxs)("div",{className:a().commentSubInfo,children:[(0,s.jsx)(l.Z,{rating:0==n.rate?1:n.rate,className:a().rateStars}),(0,s.jsx)("div",{className:a().commentDate,children:(0,r.Iq)(n.creationDate)})]})]})]}),(0,s.jsx)("p",{className:a().commentContent,children:u}),m&&(0,s.jsxs)("div",{className:a().hasMore,onClick:()=>{t(!0)},children:[(0,s.jsx)("span",{className:a().hasMoreDash,children:"- "}),"بیشتر"]}),o&&!m&&(0,s.jsxs)("div",{className:a().hasMore,onClick:()=>{t(!1)},children:[(0,s.jsx)("span",{className:a().hasMoreDash,children:"- "}),"بستن"]})]})}},79415:function(e,o,t){"use strict";var s=t(85893);o.Z=()=>(0,s.jsx)("div",{style:{textAlign:"center"},children:"در حال آماده سازی"})},52303:function(e,o,t){"use strict";t.d(o,{Z:function(){return J}});var s=t(85893),n=t(67799),a=t(15046),r=t.n(a),c=t(15991),i=t.n(c),l=t(64503),d=t(41664),m=t.n(d),u=t(11163),x=t(85786),_=t(67294),h=t(5152),b=t.n(h);let k=b()(()=>Promise.all([t.e(6502),t.e(1356)]).then(t.bind(t,11356)),{loadableGenerated:{webpack:()=>[11356]}});var p=e=>{let{comments:o,commentsCount:t,device:n="desktop"}=e,a=(0,u.useRouter)(),r=(0,_.useMemo)(()=>"/".concat(a.pathname.includes("audiobook")?"audiobook":"book","-review/").concat(a.query.id,"/").concat(a.query.name,"?p=1"),[]);return(0,s.jsxs)("div",{className:"".concat(i().commentBox," box-swiper"),children:[(0,s.jsxs)("div",{className:i().header,children:[(0,s.jsx)("h2",{children:"نظرات کاربران"}),(0,s.jsx)("div",{className:i().headerMore,children:(0,s.jsxs)(m(),{href:r,className:i().headerMore,children:[(0,s.jsx)("span",{className:"d-none d-sm-block",children:"مشاهده همه "}),"(".concat((0,x.Iq)(t.toString()),")")]})})]}),(0,s.jsx)("div",{className:i().comments,children:"mobile"===n?o.map((e,o)=>(0,s.jsx)(l.Z,{comment:e},o)):(0,s.jsx)(k,{comments:o})})]})},j=t(97762),f=t(5022),v=t(95692),N=t(89196),g=t.n(N),B=e=>{let{faqs:o}=e;return(0,s.jsx)("ul",{children:o.map((e,o)=>(0,s.jsxs)("li",{className:g().faq,children:[(0,s.jsx)("p",{className:g().question,children:e.question}),(0,s.jsx)("p",{className:g().answer,children:e.answer})]},o))})};let w=(0,_.memo)(e=>{let{info:o,boxTitle:t}=e,{json:n,faqs:a,content:r}=o,c=(0,_.useRef)(null),i=n?j.renderToStaticMarkup((0,v.jH)(JSON.parse(r)).blocks.map(e=>{if(e&&e.type)switch(e.type){case"unstyled":return(0,s.jsx)("p",{children:e.spans.map((e,o)=>{switch(e.style){case"LINK":return"_self"==e.data.targetOption?(0,s.jsx)(m(),{href:e.data.url,children:e.text},o):(0,s.jsx)("a",{href:e.data.url,children:e.text},o);case"BOLD":return(0,s.jsx)("span",{style:{fontWeight:"bold"},children:e.text},o);case"ITALIC":return(0,s.jsx)("span",{style:{fontStyle:"italic"},children:e.text},o);default:return(0,s.jsx)("span",{className:e.style,children:e.text},o)}})},e.key);case"H1":return(0,s.jsx)("h1",{children:e.text},e.key);case"H2":return(0,s.jsx)("h2",{children:e.text},e.key);case"H3":return(0,s.jsx)("h3",{children:e.text},e.key);case"H4":return(0,s.jsx)("h4",{children:e.text},e.key);case"H5":return(0,s.jsx)("h5",{children:e.text},e.key);case"H6":return(0,s.jsx)("h6",{children:e.text},e.key);case"IMAGE":return(0,s.jsx)("div",{className:g().center,children:(0,s.jsx)(f.X,{placeHolder:e.src,src:e.src,alt:e.alt,title:e.alt})},e.key);case"EMBEDDED_LINK":return(0,s.jsx)("div",{className:g().videoBox,children:(0,s.jsx)("video",{controls:!0,children:(0,s.jsx)("source",{src:e.src,type:"video/mp4"})})},e.key)}})):r;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:g().bookDescriptionHeader,ref:c,children:"معرفی "+t}),(0,s.jsx)("div",{className:g().bookDescriptionContent,dangerouslySetInnerHTML:{__html:i}}),a&&(0,s.jsx)(B,{faqs:a})]})},(e,o)=>e.bookId===o.bookId);var q=t(30964),y=t.n(q),C=t(43784);let S=b()(()=>Promise.all([t.e(6502),t.e(1098)]).then(t.bind(t,91098)),{loadableGenerated:{webpack:()=>[91098]}});var I=e=>{let{quotes:o,quotesCount:t,device:n="desktop"}=e,a=(0,u.useRouter)();return(0,s.jsxs)("div",{className:"".concat(y().quoteBox," box-swiper"),children:[(0,s.jsxs)("div",{className:y().header,children:[(0,s.jsx)("div",{className:y().headerTitle,children:"بریده‌هایی از کتاب"}),(0,s.jsxs)(m(),{href:"/book-quote/".concat(a.query.id,"/").concat(a.query.name,"?p=1"),className:y().headerMore,children:[(0,s.jsx)("span",{className:"d-none d-sm-block",children:"مشاهده همه "}),"(".concat((0,x.Iq)(t.toString()),")")]})]}),(0,s.jsx)("div",{className:y().quotes,children:"mobile"===n?o.map((e,o)=>(0,s.jsx)(C.Z,{quote:e},o)):(0,s.jsx)(S,{quotes:o})})]})},D=t(84203),M=t(49706),H=t(91655),P=t(59253),O=t(54952),E=t(5327),A=t.n(E);let T=_.memo(e=>{let{text:o,closeBox:t,isOpen:n}=e;return(0,s.jsx)("div",{className:"".concat(A().offCodeContainer," ").concat(n?"":A().close),children:(0,s.jsxs)("div",{className:A().offCode,children:[(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:o}}),(0,s.jsx)("span",{className:"icon-close",onClick:()=>t()})]})})},(e,o)=>e.text===o.text&&e.isOpen===o.isOpen);var Z=t(87447),G=t(46582),Q=t(92331),L=t(4108),R=t(68547),X=t(45347);let U=b()(()=>Promise.all([t.e(6502),t.e(2073)]).then(t.bind(t,72073)),{loadableGenerated:{webpack:()=>[72073]}}),Y=b()(()=>t.e(2071).then(t.bind(t,32071)),{loadableGenerated:{webpack:()=>[32071]}}),V=b()(()=>t.e(8683).then(t.bind(t,78683)),{loadableGenerated:{webpack:()=>[78683]}});var F=e=>{let{device:o,box:t}=e,a=(0,_.useRef)(),[c,i]=(0,_.useState)(!1),[l,d]=(0,_.useState)(!1);return(0,_.useEffect)(()=>{d(!0)},[]),(0,_.useEffect)(()=>{let e;return"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?(e=new IntersectionObserver(o=>{o[0].isIntersecting&&(i(!0),e.disconnect())}),a.current&&e.observe(a.current)):i(!0),()=>{e&&e.disconnect()}},[t]),(0,s.jsx)("div",{className:"container",ref:a,children:c?(0,s.jsx)(V,{box:t,children:"mobile"===o?(0,s.jsx)("div",{className:r().noSwiper,children:t.bookData.books.map((e,o)=>(0,s.jsx)(Y,{book:e,boxTitle:t.title},o))}):(0,s.jsx)(U,{box:t})}):l?(0,s.jsx)(R.Z,{}):(0,s.jsx)("div",{children:t.bookData.books.map(e=>{var o;let t=!!(null==e?void 0:null===(o=e.types)||void 0===o?void 0:o.find(e=>(null==e?void 0:e.id)===(null===n.MC||void 0===n.MC?void 0:n.MC.Audio)));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("a",{href:"/".concat(t?"audiobook":"book","/").concat(e.id,"/").concat((0,x.QN)(e.title)),children:e.title}),(0,s.jsx)("a",{children:(0,s.jsx)(f.X,{src:e.coverUri+"?w=150",placeHolder:""})}),e.authors&&e.authors.length>0&&(0,s.jsx)(X.Z,{className:r().bookAuthor,destination:{type:n.gG.Filters,filters:{slug:e.authors[0].slug,list:[{type:n.vA.author,value:e.authors[0].id}]}},children:(0,s.jsxs)("div",{children:[e.authors[0].firstName," ",e.authors[0].lastName]})})]})})})})};let W=b()(()=>Promise.all([t.e(334),t.e(1506)]).then(t.bind(t,40334)),{loadableGenerated:{webpack:()=>[40334]}}),K=b()(()=>t.e(8430).then(t.bind(t,18430)),{loadableGenerated:{webpack:()=>[18430]}}),z=b()(()=>Promise.resolve().then(t.bind(t,35081)),{loadableGenerated:{webpack:()=>[35081]}});var J=e=>{var o;let t;let{bookPage:a,bc:c,device:i,audioData:l}=e,d=a.book,[m,u]=(0,_.useState)(!0),{isAuthenticated:x,loading:h,user:b}=(0,_.useContext)(M.V),[k,j]=(0,_.useState)(!1),[f,v]=(0,_.useState)(!1),[N,g]=(0,_.useState)(!1),[B,q]=(0,_.useState)(d.price),[y,C]=(0,_.useState)(d.beforeOffPrice),[S,E]=(0,_.useState)(d.subscriptionAvailable),A=(0,_.useContext)(Q.b5),R=e=>({...e,bookData:{books:e.books}});return(0,_.useEffect)(()=>(x?(0,H.ZD)(b.id,d.id).then(e=>{if(e.status==n.kF.Success){let o=1==e.result.status||2==e.result.status;g(3==e.result.status),j(e.result.isOnDesk),v(o)}}):(g(!1),j(!1),v(!1)),()=>{g(null),v(null),j(null)}),[x,d]),(0,_.useEffect)(()=>(fetch("".concat(Z.Z.webApi.getServer,"/v2/book/").concat(d.id,"/priceinfo?trackingData=").concat(G.l.trackingData)).then(e=>e.json()).then(e=>{C(e.beforeOffPrice),q(e.price),E(e.subscriptionAvailable)}),()=>{q(null),C(null),E(null)}),[d]),(0,_.useEffect)(()=>("mobile"===i&&A(!1),()=>{A(!0)}),[]),(0,_.useEffect)(()=>{h||a.book.state!==n.Qc.active?h||a.book.state!==n.Qc.NoElectronic||(t={item_id:d.id.toString(),item_name:d.title,item_category:d.categories[0]?d.categories[0].title:"1",item_brand:d.publisher,currency:"USD",price:"",item_variant:"physical"},(0,L.N1)("view_item","",t)):(t={item_id:d.id.toString(),item_name:d.title,item_category:d.categories[0]?d.categories[0].title:"1",item_brand:d.publisher,currency:"USD",price:a.book.price,item_variant:"Text"},(0,L.N1)("view_item",a.book.price,t))},[h]),(0,s.jsxs)("div",{className:r().background,children:[(null===(o=a.HeaderText)||void 0===o?void 0:o.length)>0&&(0,s.jsx)(T,{text:a.HeaderText,closeBox:()=>{u(!1)},isOpen:m}),(0,s.jsx)(O.Z,{bc:c}),(0,s.jsxs)("div",{className:"".concat(r().bookPageContainer,"\n					container\n				"),children:[(0,s.jsx)(P.Z,{book:a.book,shareText:d.shareText,isOwned:f,isMarked:N,setIsMarked:g,className:d.correspondingBooks?r().bookHeader:"",audioData:l,titlePrefix:d.isAudio?"دانلود و خرید":""}),"mobile"===i&&(0,s.jsx)(W,{bookPage:a,isOwned:f,subscriptionAvailable:S,isBorrowed:k}),"desktop"===i&&a.book.correspondingBooks&&(0,s.jsx)("div",{className:r().corresponding,children:(0,s.jsx)(z,{correspondingBooks:a.book.correspondingBooks,type:a.book.type})}),a.bookRows.map((e,o)=>{switch(e.type){case n.ax.BookDescription:return(0,s.jsx)("div",{id:"book-description",className:"".concat(r().bookDescription," container"),children:(0,s.jsx)(w,{info:e,bookId:d.id,boxTitle:d.prefix+" "+d.title})},o);case n.ax.BookList:case n.ax.WithOthers:let t=R(e);return(0,s.jsx)("div",{className:r().otherBooksBox,children:(0,s.jsx)(F,{device:i,box:t})},o);case n.ax.AuthorInfo:return(0,s.jsx)(K,{author:e.author},o)}}),(0,s.jsx)("div",{id:"book-comments",className:r().comments,children:a.commentsCount>0?(0,s.jsx)("div",{className:"container",children:(0,s.jsx)(p,{comments:a.comments,commentsCount:a.commentsCount,device:i})}):(0,s.jsx)("span",{className:"".concat(r().noComment," container"),children:"نظری برای کتاب ثبت نشده است"})}),!d.isAudio&&(0,s.jsx)("div",{id:"book-quotes",className:r().quotes,children:a.quotesCount>0?(0,s.jsx)("div",{className:"container",children:(0,s.jsx)(I,{quotes:a.quotes,quotesCount:a.quotesCount,device:i})}):(0,s.jsx)("span",{className:"".concat(r().noQuote," container"),children:"بریده‌ای برای کتاب ثبت نشده است"})})]}),"desktop"===i&&(0,s.jsx)(D.Z,{price:B,className:m?"":r().buyBox,bookPage:a,beforeOffPrice:y,isBorrowed:k,isOwned:f,subscriptionAvailable:S})]})}},43784:function(e,o,t){"use strict";var s=t(85893),n=t(58158),a=t.n(n);o.Z=e=>{let{quote:o}=e;return(0,s.jsxs)("div",{className:"".concat(a().quote," swiper-slide icon-quotation"),children:[(0,s.jsx)("div",{className:"".concat(a().quoteContent),children:o.data.quote}),(0,s.jsx)("div",{className:"".concat(a().quoteAccount),children:o.nickname})]})}},15991:function(e){e.exports={commentBox:"commentBox_commentBox__aXMaN",header:"commentBox_header__mYVFx",headerMore:"commentBox_headerMore__RblUv",navIcon:"commentBox_navIcon__wXTxO",disabled:"commentBox_disabled__ixl_K",comments:"commentBox_comments__cDWNt",next:"commentBox_next__3_TcV",prev:"commentBox_prev__xWV4Y"}},89196:function(e){e.exports={bookDescriptionHeader:"bookDescription_bookDescriptionHeader__1ptrU",bookDescriptionContent:"bookDescription_bookDescriptionContent__I5MGS",center:"bookDescription_center__WorrX",showMoreBtn:"bookDescription_showMoreBtn__bsakB"}},30964:function(e){e.exports={quoteBox:"quoteBox_quoteBox__xep9Z",header:"quoteBox_header__pE1Yn",headerMore:"quoteBox_headerMore__7nHen",quotes:"quoteBox_quotes__6QrzT"}},98772:function(e){e.exports={comment:"comment_comment__c8Rvb",commentHeader:"comment_commentHeader__34o5m",user:"comment_user__miIDY",bookHeaderInfo:"comment_bookHeaderInfo__iXbOx",bookHeaderNickname:"comment_bookHeaderNickname__qwgoI",commentSubInfo:"comment_commentSubInfo__I3BBi",rateStars:"comment_rateStars__hHPhx",commentContent:"comment_commentContent__PEY6H",hasMore:"comment_hasMore__3qcgA",hasMoreDash:"comment_hasMoreDash__cdJyI"}},5327:function(e){e.exports={offCodeContainer:"welcomeOfferBanner_offCodeContainer__ThSWx",close:"welcomeOfferBanner_close__d6QEi",hide:"welcomeOfferBanner_hide__zY9MI",hideSmall:"welcomeOfferBanner_hideSmall__8G_KT",offCode:"welcomeOfferBanner_offCode__fBVA8","close-off":"welcomeOfferBanner_close-off__1BQnj"}},15046:function(e){e.exports={background:"bookPage_background__jCVCr",bookPageContainer:"bookPage_bookPageContainer__O_OHZ",corresponding:"bookPage_corresponding__BEml6",bookDescription:"bookPage_bookDescription__zo3E1",otherBooksBox:"bookPage_otherBooksBox__KM8aw",noSwiper:"bookPage_noSwiper__2LlBX",comments:"bookPage_comments__k9iYF",noComment:"bookPage_noComment__NxXgU",quotes:"bookPage_quotes__gVLAu",noQuote:"bookPage_noQuote__QgRMy",moreInfo:"bookPage_moreInfo__fQfw1",correspondingBooks:"bookPage_correspondingBooks__XUaok",bookHeader:"bookPage_bookHeader__pSZOM",buyBox:"bookPage_buyBox__ki1So",hideSmall:"bookPage_hideSmall__tSYJa"}},58158:function(e){e.exports={quote:"quote_quote__5hwsa",quoteContent:"quote_quoteContent__ISaDx",quoteAccount:"quote_quoteAccount__rj1qQ"}}}]);