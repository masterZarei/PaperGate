@page
@model PaperGate.Web.Pages.Account.Admin.Preferences.AboutUsManagementModel
@{
    ViewData["Title"] = "مدیریت درباره ما";
}

<div class="space-x-normal py-8">
    <ul class="breadcrumb">
        <li><a class="hover:text-blue-600 transition" href="~/">خانه</a> <span class="text-gray-500">/</span></li>
        <li><a class="hover:text-blue-600 transition" href="~/Account/Admin">پنل</a> <span class="text-gray-500">/</span></li>
        <li><a class="hover:text-blue-600 transition" href="#">مدیریت درباره ما</a></li>
    </ul>
    <div class="block tablet:flex justify-between">
        @await Component.InvokeAsync("SidePanelComponent")
        <div class="w-full tablet:w-9/12 px-3 mt-5">
            <div class="PanelCard border rounded p-3">
                <!--                تایتل-->
                <div class="PanelCard-header">
                    <h2 class="text-lg">مدیریت درباره ما</h2>
                </div>
                <div class="PanelCard-body pt-2">
                    <form method="post" enctype="multipart/form-data">
                        <input type="hidden" asp-for="AboutUsDto.Id" />
                        <input type="hidden" asp-for="AboutUsDto.Image" />

                        <div class="block">
                            <div class="w-full px-2 my-3">
                                <label class="customLabel"> درباره ما </label>
                                <textarea asp-for="AboutUsDto.Description" type="text" rows="8" class="customInput"></textarea>
                            </div>
                            <div class="w-full tablet:flex px-2 my-3">
                                <div class="w-full tablet:w-1/2 px-3 mt-2 tablet:mt-0">
                                    <div class="flex flex-col mt-3">
                                        <label class="customLabel"> عکس درباره ما </label>
                                        <label for="imgUp"
                                               class="mt-3 text-white py-1 rounded-md pr-4 bg-indigo-600 cursor-pointer flex flex-row-reverse justify-between">
                                            <input type="file" accept="image/*" id="imgUp" asp-for="AboutUsDto.ImageUpload">
                                            <span class="text-center">آپلود فایل</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="w-full tablet:w-1/2 px-3 mt-2 tablet:mt-0">
                                    <img src="@(string.IsNullOrEmpty(Model?.AboutUsDto?.Image) ? "~/images/empty.jpg" : $"/Assets/Pictures/Preferences/{Model?.AboutUsDto?.Image}")" @* src="~/Assets/Pictures/Preferences/@Model?.AboutUsDto?.Image" *@ class="w-full h-64 border" id="imgPreview">
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="w-full flex px-2">
                            <div class="w-1/2 py-3 pl-3">
                                <button type="submit" class="subBtn btnSuccess">
                                    تایید
                                </button>
                            </div>
                            <div class="w-1/2 py-3 pr-3">
                                <a href="~/" class="subBtn btnDark">
                                    بازگشت
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
            function readURL1(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $('#imgPreview').attr('src', e.target.result);
                    }

                    reader.readAsDataURL(input.files[0]); // convert to base64 string
                }
            }
            $("#imgUp").change(function () {
                readURL1(this);
            });

            document.getElementById('imgUp').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const validImageTypes = ['image/jpeg', 'image/png', 'image/gif','image/jpg'];
                if (!validImageTypes.includes(file.type)) {
                    alert('فقط فایل‌های تصویری مجاز هستند.');
                    event.target.value = ''; // بازنشانی ورودی
                }
            }
        });
    </script>
}